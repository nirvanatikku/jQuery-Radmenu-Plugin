(function(f){function v(a,c){var b=f.extend({},w,c);return a.each(function(){var d=f(this);d.find("."+b.listClass).find("."+b.itemClass).hide();d.data(m,s(b,b.initialScale,b.radius));for(e in t)d.bind(e+j,d,t[e])})}function x(a){var c=f(this),b=f(a.target),d=f.radmenu.container;b.hasClass(d.itemClz)||(b=b.closest("."+d.itemClz));var g=b.parents("."+d.itemClz).length>0;b=b.index();g?c.radmenu(b):c.parents("."+d.clz).radmenu(b);n(a)}function n(a){if(f.support.opacity)a.stopPropagation();else window.event.cancelBubble=
true}function s(a,c,b){return f.extend({},a,{radius:b*c})}function o(a){return parseInt(Math.random()*a)}function i(a){var c=a.data;return{menu:c,opts:c.data(m),raditems:function(){return c.find("."+f.radmenu.container.itemClz)}}}function p(a,c,b,d){if(c==b)b=c-1;var g=f(a.raditems()[c]),h=a.raditems()[b];c>b?g.insertBefore(h):g.insertAfter(h);y(a,d)}function z(a,c){var b="";a.each(function(d){var g=f(this);d=q(d+1,a.length,c);b+="<div class='"+f.radmenu.container.itemClz+"' ";b+="style='position:absolute;left:"+
d.x+"px;top:"+d.y+"px;display:none;'>";b+=g.html();b+="</div>"});return b}function q(a,c,b){var d=b.radius,g=b.angleOffset;c=2*Math.PI*parseFloat(a/c);a=b.centerX+Math.cos(c+g)*d;b=b.centerY+Math.sin(c+g)*d;return{x:a,y:b}}function y(a,c){var b=a.menu.find("."+f.radmenu.container.itemClz),d=b.length;b.each(function(g){var h=f(this),k=q(g+c,d,a.opts);h.animate({left:k.x,top:k.y},a.opts.animSpeed,a.opts.animEasing,g==d-1?function(){a.opts.afterAnimation(a)}:undefined)})}var j=".radmenu",m="options"+j,r="prevoptions"+
j,w={listClass:"list",itemClass:"item",activeItemClass:"active",selectEvent:null,onSelect:function(){},radius:10,initialScale:1,angleOffset:0,centerX:0,centerY:0,animSpeed:500,animEasing:"swing",scaleAnimSpeed:400,scaleAnimOpts:{},afterAnimation:function(){},onShow:function(a){a.show()},onHide:function(a){a.hide()},onScaleItem:function(){}};f.radmenu={container:{clz:"radial_div",itemClz:"radial_div_item",html:"<div></div>",css:{position:"relative"}}};f.fn.radmenu=function(a,c){try{var b=f(this),d=typeof a;if(arguments.length==
0||d=="object")return v(b,a);else if(d=="string")return a=="items"?b.triggerHandler(a+j):b.trigger(a+j,c||null);else if(d=="number")return b.trigger("select"+j,a)}catch(g){return"error : "+g}};var t={show:function(a,c){var b=i(a),d=f.radmenu.container;b.menu.find("."+d.clz).remove();var g=b.menu.find("."+b.opts.itemClass),h=f(d.html).addClass(d.clz).css(d.css).html(z(g,b.opts));g=h.find("."+d.itemClz);b.opts.selectEvent!=null&&g.bind(b.opts.selectEvent,x);h.appendTo(b.menu);typeof c=="function"?c(g):
b.opts.onShow(g);n(a)},hide:function(a){var c=i(a),b=c.menu.find("."+f.radmenu.container.clz);c.opts.onHide(b.find("."+f.radmenu.container.itemClz));b.remove();n(a)},select:function(a,c){var b=i(a);c=f(b.raditems().get(c));c.siblings().removeClass(b.opts.activeItemClass);c.addClass(b.opts.activeItemClass);b.opts.onSelect(c);n(a)},next:function(a){a=i(a);p(a,a.raditems().length-1,0,1)},prev:function(a){a=i(a);p(a,0,a.raditems().length-1,1)},shuffle:function(a,c){a=i(a);var b=a.raditems().length;p(a,
o(b),o(b),o(c||15))},destroy:function(a){a=i(a);a.menu.data(m,null).data(r,null).unbind(j);return a.menu},items:function(a){return i(a).raditems()},scale:function(a,c){var b=i(a);if(c){var d=b.opts;a=f.radmenu.container;var g=b.menu.data(r);g||b.menu.data(r,g=d);var h=b.menu.find("."+a.itemClz),k=s(d,c,g.radius);b.menu.data(m,k);h.each(function(l){var u=f(this);l=q(l+1,h.length,k);var A=f.merge({left:l.x,top:l.y},d.scaleAnimOpts);u.animate(A,d.scaleAnimSpeed);b.opts.onScaleItem(u,c,l)})}return b.menu}}})(jQuery);
